syntax = "proto3";

package ringbahn.v1;

import "ringbahn/v1/device_common.proto";

// Top-level Rover device command message
message RoverDeviceCommand {
  oneof command {
    // Common commands
    SystemInfoRequest system_info = 1; // Response: SystemInfoResponse
    PingCommand ping = 2; // Response: CommandResult
    ResetCommand reset = 3; // Response: CommandResult

    // Rover-specific commands
    RoverMovementCommand movement = 10; // Response: CommandResult
    RoverGetStateRequest get_state = 11; // Response: RoverDeviceState
  }
}

// ===== Rover-Specific Commands =====

// Response: RoverDeviceState
message RoverGetStateRequest {}

// Current rover device state
message RoverDeviceState {
  int64 timestamp_ms = 1; // When state was captured (milliseconds since epoch);
  bool tracks_active = 2; // Indicates if any track is moving;
  sint32 left_track_speed = 3; // Left track: -100 (full reverse) to +100 (full forward), 0 = stopped;
  sint32 right_track_speed = 4; // Right track: -100 (full reverse) to +100 (full forward), 0 = stopped;
}

// Response: CommandResult
message RoverMovementCommand {
  bool tracks_active = 1; // Set false to stop all tracks immediately;
  sint32 left_track_speed = 2; // Left track: -100 (full reverse) to +100 (full forward), 0 = stopped;
  sint32 right_track_speed = 3; // Right track: -100 (full reverse) to +100 (full forward), 0 = stopped;
}
